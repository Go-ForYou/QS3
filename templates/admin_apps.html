{% extends 'base.html' %}
{% block content %}
<div class="layout">
	<aside class="sidenav blue">
		<a href="{{ url_for('admin_books') }}">已签约书籍</a>
		<a href="{{ url_for('admin_royalties') }}">保底稿费管理</a>
		<a href="{{ url_for('admin_apps') }}" class="active">申请审核</a>
	</aside>
	<section class="main">
		<h1>申请审核</h1>
		<ul>
			{% for a in apps %}
				<li class="card">
					<div>#{{ a[0] }} 作者：{{ a[1] }} —— 《{{ a[2] }}》/{{ a[3] }}/{{ a[4] }}</div>
					<div>状态：{{ a[5] }}</div>
					<div>提交：{{ a[7] }}</div>
					{% if a[5]=='pending' %}
						<form method="post" class="inline">
							<input type="hidden" name="action" value="approve_app">
							<input type="hidden" name="app_id" value="{{ a[0] }}">
							{% if a[4]=='买断' %}
								<input name="buyout_amount" type="number" step="0.01" placeholder="买断稿费" required>
							{% endif %}
							<button type="submit">同意签约</button>
						</form>
						<form method="post" class="inline">
							<input type="hidden" name="action" value="reject_app">
							<input type="hidden" name="app_id" value="{{ a[0] }}">
							<input name="reason" placeholder="拒绝原因" required>
							<button type="submit">拒绝</button>
						</form>
					{% elif a[5]=='rejected' and a[6] %}
						<div>原因：{{ a[6] }}</div>
					{% endif %}
				</li>
			{% else %}
				<li>暂无申请</li>
			{% endfor %}
		</ul>
	</section>
</div>
{% endblock %}
